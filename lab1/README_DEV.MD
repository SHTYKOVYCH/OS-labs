# План разработки #

## Части программы ##
1. Функция обработчик ошибок **(сделано)**
2. Функция-обработчик входных параметров (Коля) **(сделано)**
3. Главная функция **(в процессе, дальнейшее расширение по выполнению пунктов ниже)**
4. Функции работы с файлами
    - Функция чтения из файла (Коля) **(сделано)**
    - Функция записи в файл **(сделано)**
    - Функция перевода указателя в файле (Коля) **(сделано)**
5. Функции работы с JSON
    - Функция парсера строки в JSON (Коля) **(сделано)**
    - Функция перевода структуры JSON в строку
    - Функция чтения JSON из файла
6. Основные функции архиватора
   - Функция-архиватор (Коля)
   - Функция распаковщик

## Описание файла архива ##
- В начале идет строка "archive", чтобы отличать файл и ненароком не начать воспринимать изображения за архивы
- Далее 4 байта - беззнаковое целое - общее кол-файлов
- Файлы и их данные друг за другом:
  - В начале идет JSON без пробелов и переносов строки вида:
    ```
    { 
        // Запятая после очередного поля обязательна
        name: <название файла>, 
        parentDir: <родительская папка>, // название папки либо '.', т е текущая директория
        size: <размер в байтах>, // ограничимся unsigned int, его должно хватить для наших учебных проектов. 
        // Присутсвует только для файлов 
        type: "f/d", // Файл/Директория
    }
    ```
  - Далее идут сырые данные файла

## Подробное описание частей программы ##


1. #### Функция-обработчик ошибок: ####
   - Принимает код ошибки и указатели, из которых надо очистить память. 
   - Коды ошибок соотвественно(можно дополнять):
     1. Ошибка недопустимого параметра
     2. Ошибка отсутсвия параметра
     3. Ошибка чтения из файла
     4. Ошибки записи в файл
     5. Ошибка парсера JSON
   - ###Функция полностью останавливает программу, если передан код, отличный от кода успеха**

2. #### Функция-обработчик входных параметров:
   1. Функция должна принимать: 
      - argc
      - argv 
      - Ссылка на структуру данных <вставить имя структуры данных> с полями:
        - depack - true/false (с поправкой на char из C) - деархивируем или нет
        - inputFile - char* - имя входного файла
        - outputFile - char* - имя выходного файла. Если не задано, то:
            - Если не задан inputFile, то равно archive
            - Если задан inputFile, то равно archive_\<inputFile>
      > Стоит заметить, что в Unix есть ограничение на длину имени файла - 255 символов, из недопустимых символов только: . .. /
   2. Функция возвращает:
      - true/false - в зависимости от успешности операции
   3. Общий принцип работы функции:
      1. Создает структуру в памяти с заданными по умолчанию параметрами
      2. Парсит входные аргументы и заносит их в структуру
      3. Если встречает недопустимый параметр или ненаходит параметр входного файла, выдает ошибку 2


3. #### Главная функция:
   1. Функция принимаeт:
       - argc
       - argv 
   2. Функция возвращает:
       - 0 или 1 в зависимости от успеха выполнения
   3. Общий принцип:
      1. Создает структуру параметров в памяти
      2. Вызывает обработчик входных параметров
      3. На основе полученных аргументов вызывает функцию архиватор/распаковщик
      
4. #### Функции работы с файлами
    - Функция чтения из файла
      - Функция принимает:
        - открытый файл
        - Кол-во данных в байтах, которое нужно считать
      - Функция возвращает:
        - указатель void, указывающий на область памяти с считанными данными
    - Функция записи в файл
      - Функция принимает:
        - указатель на файл
        - кол-во данных, которое нужно записать(в байтах)
        - указатель void на область памяти, из которой надо считать данные
      - Функция возвращает:
        - Хз, тут надо будет подумать
    - Функция перевода указателя в файле:
      - Функция принимает:
        - число - на какое кол-во байт необходимо сместиться
      - Функция возвращает:
        - Надо подумать между "успех/неуспех" и "ничего"

5. #### Функции работы с JSON

    - **Далее структура JSON повторяет структуру, описанную в разделе [Описание файла архива](#Описание-файла-архива)**  
   
    - Функция парсера строки в JSON:
      - Функция принимает:
        - Строка, которую надо распарсить
        - Указатель на структуру, в которую будет записываться результат
      - Функция возвращает:
        - true/false - успешность парсинга
   
    - Функция перевода структуры JSON в строку:
      - Функция принимает:
        - Ссылка на структуру данных, которая будет преобразована в JSON
      - Функция возвращает:
        - Строка
        
6. #### Основные функции архиватора
    - Функция-архиватор
    - Функция распаковщик